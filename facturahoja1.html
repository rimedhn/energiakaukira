<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Factura Energía Kaukira</title>
    <style type="text/css">
      body {
        margin: 0;
        padding: 0;
        font-family: Arial, sans-serif;
      }

      #letter-size {
        width: 7.2in;
        margin: 0.3in auto;
        padding: 0;
      }

      .cabecera {
        border: 1px solid #000;
        padding: 10px;
        margin-bottom: 8px;
        width: 100%;
        box-sizing: border-box;
      }
      .cabecera-table {
        width: 100%;
        border-collapse: collapse;
      }
      .cabecera-table td {
        border: none;
        vertical-align: top;
        font-size: 16px;
        padding: 0 2px 0 2px;
        line-height: 1.1;
      }
      .empresa-titulo {
        font-weight: bold;
        font-size: 22px;
      }
      .subtitulo {
        font-size: 16px;
        font-weight: bold;
      }

      .factura-section {
        border: 1px solid #000;
        margin-bottom: 8px;
        padding: 5px 0 0 0;
      }
      .factura-table {
        width: 100%;
        border-collapse: collapse;
      }
      .factura-table th, .factura-table td {
        border: 1px solid #000;
        padding: 4px 6px;
        font-size: 15px;
        vertical-align: top;
      }
      .factura-table th {
        background-color: #fff;
        font-weight: bold;
        text-align: left;
      }
      .factura-table .center {
        text-align: center;
      }

      .lectura-section {
        border: 1px solid #000;
        margin-bottom: 8px;
        padding: 0;
      }
      .lectura-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 15px;
      }
      .lectura-table th, .lectura-table td {
        border: 1px solid #000;
        padding: 4px 6px;
      }
      .lectura-table th {
        text-align: center;
        font-weight: bold;
        background: #fff;
      }

      .calculo-section {
        border: 1px solid #000;
        margin-bottom: 8px;
        padding: 0;
      }
      .calculo-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 15px;
      }
      .calculo-table th, .calculo-table td {
        border: 1px solid #000;
        padding: 4px 6px;
      }
      .calculo-table th {
        background: #fff;
        font-weight: bold;
        text-align: center;
      }

      .footer {
        font-size: 15px;
        margin-top: 10px;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <div id="letter-size">
      <!-- CABECERA -->
      <div class="cabecera">
        <table class="cabecera-table">
          <tr>
            <td style="width:55%; vertical-align:top;">
              <span class="empresa-titulo" id="empresa"></span><br>
              RTN: <span id="rtn"></span>
            </td>
            <td style="width:45%;">
              <span id="direccion"></span><br>
              Teléfono: <span id="telefono"></span><br>
              Gerencia: <span id="gerencia"></span><br>
              Cuenta en Banco Atlántida: <span id="cuenta"></span><br>
              <span id="nombrebanco"></span>
            </td>
          </tr>
        </table>
      </div>

      <!-- FACTURA -->
      <div class="factura-section">
        <table class="factura-table">
          <tr>
            <th colspan="4" class="center" style="font-size:20px;">
              <span id="tipodoc"></span> <span id="factura"></span>
            </th>
          </tr>
          <tr>
            <td colspan="4" class="center" style="font-size:12px;">
              CAI: <span id="cai"></span><br>
              RangoAutorizado: <span id="rango"></span><br>
              FechaLimite: <span id="limite"></span>
            </td>
          </tr>
          <tr>
            <th colspan="2" class="center">Datos del cliente</th>
            <th colspan="2" class="center">Datos generales</th>
          </tr>
          <tr>
            <td>Cliente: <span id="cliente"></span></td>
            <td>Dirección: <span id="direccioncliente"></span></td>
            <td>Fecha: <span id="date"></span></td>
            <td>Tipo/S: <span id="tipos"></span></td>
          </tr>
          <tr>
            <td>Contador: <span id="contador"></span></td>
            <td></td>
            <td>Tipo/C: <span id="tipoc"></span></td>
            <td></td>
          </tr>
        </table>
      </div>

      <!-- LECTURA -->
      <div class="lectura-section">
        <table class="lectura-table">
          <tr>
            <th colspan="2" style="width:50%">Detalle lectura</th>
            <th colspan="2" style="width:50%">Kit de instalación</th>
          </tr>
          <tr>
            <td>Lectura actual</td>
            <td><span id="lecturaactual"></span></td>
            <td>Saldo anterior</td>
            <td><span id="saldoanterior"></span></td>
          </tr>
          <tr>
            <td>Lectura anterior</td>
            <td><span id="lecturaanterior"></span></td>
            <td>Abono</td>
            <td><span id="abono"></span></td>
          </tr>
          <tr>
            <td>Consumo Kw</td>
            <td><span id="consumokw"></span></td>
            <td>Saldo por pagar</td>
            <td><span id="saldoporpagar"></span></td>
          </tr>
          <tr>
            <td colspan="2">Usuario: <span id="usuario"></span></td>
            <td colspan="2">Reporte: <span id="reporte"></span></td>
          </tr>
        </table>
      </div>

      <!-- CALCULO CONSUMO -->
      <div class="calculo-section">
        <table class="calculo-table">
          <tr>
            <th colspan="2">Calculo de consumo</th>
            <th colspan="2">Total a pagar</th>
          </tr>
          <tr>
            <td>Tarifa Kw</td>
            <td><span id="tarifakw"></span></td>
            <td>Subtotal</td>
            <td><span id="subtotal"></span></td>
          </tr>
          <tr>
            <td>Consumo del mes</td>
            <td><span id="consumomes"></span></td>
            <td>Exento</td>
            <td><span id="exento"></span></td>
          </tr>
          <tr>
            <td>Otros cargos</td>
            <td><span id="otroscargos"></span></td>
            <td>Exonerado</td>
            <td><span id="exonerado"></span></td>
          </tr>
          <tr>
            <td>Monto</td>
            <td><span id="monto"></span></td>
            <td>Gravado 15%</td>
            <td><span id="gravado15"></span></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td>Isv 15%</td>
            <td><span id="isv15"></span></td>
          </tr>
          <tr>
            <td>Fecha de expiración:</td>
            <td><span id="fechaexpiracion"></span></td>
            <td><strong>Total a pagar</strong></td>
            <td><strong><span id="totalapagar"></span></strong></td>
          </tr>
        </table>
      </div>

      <div class="footer">
        Original: Cliente, Copia: Emisor
      </div>
    </div>

    <script>
      function getQueryParam(param) {
        var urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(param) || '';
      }

      function fillData() {
        // Cabecera
        document.getElementById("empresa").textContent = getQueryParam("empresa");
        document.getElementById("rtn").textContent = getQueryParam("rtn");
        document.getElementById("direccion").textContent = getQueryParam("direccion");
        document.getElementById("telefono").textContent = getQueryParam("telefono");
        document.getElementById("gerencia").textContent = getQueryParam("gerencia");
        document.getElementById("cuenta").textContent = getQueryParam("cuenta");
        document.getElementById("nombrebanco").textContent = getQueryParam("nombrebanco");

        // Factura
        document.getElementById("tipodoc").textContent = getQueryParam("tipodoc");
        document.getElementById("factura").textContent = getQueryParam("factura");
        document.getElementById("cai").textContent = getQueryParam("cai");
        document.getElementById("rango").textContent = getQueryParam("rango");
        document.getElementById("limite").textContent = getQueryParam("limite");
        document.getElementById("cliente").textContent = getQueryParam("cliente");
        document.getElementById("direccioncliente").textContent = getQueryParam("direccioncliente");
        document.getElementById("date").textContent = getQueryParam("date");
        document.getElementById("tipos").textContent = getQueryParam("tipos");
        document.getElementById("contador").textContent = getQueryParam("contador");
        document.getElementById("tipoc").textContent = getQueryParam("tipoc");

        // Lectura
        document.getElementById("lecturaactual").textContent = getQueryParam("lecturaactual");
        document.getElementById("saldoanterior").textContent = getQueryParam("saldoanterior");
        document.getElementById("lecturaanterior").textContent = getQueryParam("lecturaanterior");
        document.getElementById("abono").textContent = getQueryParam("abono");
        document.getElementById("consumokw").textContent = getQueryParam("consumokw");
        document.getElementById("saldoporpagar").textContent = getQueryParam("saldoporpagar");
        document.getElementById("usuario").textContent = getQueryParam("usuario");
        document.getElementById("reporte").textContent = getQueryParam("reporte");

        // Calculo y total
        document.getElementById("tarifakw").textContent = getQueryParam("tarifakw");
        document.getElementById("consumomes").textContent = getQueryParam("consumomes");
        document.getElementById("otroscargos").textContent = getQueryParam("otroscargos");
        document.getElementById("monto").textContent = getQueryParam("monto");
        document.getElementById("subtotal").textContent = getQueryParam("subtotal");
        document.getElementById("exento").textContent = getQueryParam("exento");
        document.getElementById("exonerado").textContent = getQueryParam("exonerado");
        document.getElementById("gravado15").textContent = getQueryParam("gravado15");
        document.getElementById("isv15").textContent = getQueryParam("isv15");
        document.getElementById("fechaexpiracion").textContent = getQueryParam("fechaexpiracion");
        document.getElementById("totalapagar").textContent = getQueryParam("totalapagar");
      }

      window.onload = function () {
        fillData();
        window.print();
      };
    </script>
  </body>
</html>
